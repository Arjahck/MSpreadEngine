"""Unit tests for malware engine."""

import unittest
from malware_engine.malware_base import Worm, Virus, Ransomware


class TestWorm(unittest.TestCase):
    """Test cases for Worm class."""

    def setUp(self):
        """Set up test fixtures."""
        self.worm = Worm("worm_1", infection_rate=0.5)

    def test_worm_creation(self):
        """Test creating a worm instance."""
        self.assertEqual(self.worm.malware_id, "worm_1")
        self.assertEqual(self.worm.infection_rate, 0.5)

    def test_mark_infected(self):
        """Test marking devices as infected."""
        self.worm.mark_infected("device_1")
        self.assertIn("device_1", self.worm.infected_devices)

    def test_get_infected_count(self):
        """Test getting the count of infected devices."""
        self.worm.mark_infected("device_1")
        self.worm.mark_infected("device_2")
        self.assertEqual(self.worm.get_infected_count(), 2)

    def test_worm_behavior(self):
        """Test worm behavior characteristics."""
        behavior = self.worm.get_behavior()
        self.assertEqual(behavior["type"], "worm")
        self.assertTrue(behavior["self_replicating"])


if __name__ == "__main__":
    unittest.main()
